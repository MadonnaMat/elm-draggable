<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Elm Draggable</title><style>*{box-sizing:border-box}.cxs-display-table{display:table}.cxs-2947628758 pre .hljs-number{color:#e08}.cxs-3954183383{font-size:24px}.cxs-2947628758 a:hover{text-decoration:underline}.cxs-4066908388{clear:both}.cxs-799160745{font-size:48px}.cxs-1246195080{margin-left:-8px;margin-right:-8px}.cxs-2947628758{}.cxs-2947628758 h1{font-weight:600;line-height:1.25;font-size:48px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h2{font-weight:600;line-height:1.25;font-size:24px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h3{font-weight:600;line-height:1.25;font-size:20px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h4{font-weight:600;line-height:1.25;font-size:16px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h5{font-weight:600;line-height:1.25;font-size:14px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h6{font-weight:600;line-height:1.25;font-size:12px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 p{overflow-x:auto;margin-top:0px;margin-bottom:16px}.cxs-2947628758 code{font-family:Menlo, monospace;font-size:14px;padding:4px;background-color:#eee;border-radius:2px}.cxs-2947628758 pre{font-family:Menlo, monospace;font-size:14px;overflow-x:auto;padding:16px;margin-top:8px;margin-bottom:32px;background-color:#eee;border-radius:2px}.cxs-2947628758 pre .hljs-keyword{color:#08e}.cxs-2947628758 pre .hljs-built_in{color:#059}.cxs-2947628758 pre .hljs-type{color:#059}.cxs-2947628758 pre .hljs-literal{color:#08e}.cxs-2947628758 a{color:#08e;text-decoration: none}.cxs-2947628758 pre .hljs-regexp{color:#08e}.cxs-2947628758 pre .hljs-string{color:#059}.cxs-2947628758 pre .hljs-subst{color:#059}.cxs-2947628758 pre .hljs-symbol{color:#08e}.cxs-2947628758 pre .hljs-class{color:#08e}.cxs-2947628758 pre .hljs-function{color:#e08}.cxs-2947628758 pre .hljs-title{color:#08e}.cxs-2947628758 pre .hljs-params{color:#059}.cxs-2947628758 pre .hljs-comment{color:#059}.cxs-2947628758 pre .hljs-doctag{color:#059}.cxs-2947628758 pre .hljs-meta{color:#059}.cxs-2947628758 pre .hljs-meta-keyword{color:#08e}.cxs-2947628758 pre .hljs-meta-string{color:#08e}.cxs-2947628758 hr{margin-top:48px;margin-bottom:48px;border:0px;border-bottom-style:solid;border-bottom-width:1px;border-bottom:2px solid #ddd}.cxs-2947628758 table{border-collapse:separate;border-spacing:0px;max-width:100%;width:100%}.cxs-2947628758 th{text-align:left;line-height:inherit;vertical-align:bottom}.cxs-2947628758 td{vertical-align:top;line-height:inherit}.cxs-2947628758 img{max-width: 100%;height: auto;margin-top:16px;margin-bottom:16px}.cxs-2947628758 ul{padding-left:32px;margin-top:0px;margin-bottom:16px}@media screen and (min-width: 52em) { .cxs-799160745{font-size:72px} }@media screen and (min-width: 52em) { .cxs-3954183383{} }</style></head><body style="margin:0;"><div class="Xv" style="font-family:-apple-system, BlinkMacSystemFont, sans-serif;font-weight:400;line-height:1.5;color:#111;background-color:#fff;"><nav style="display:flex;align-items:center;padding-top:8px;padding-bottom:8px;padding-left:16px;padding-right:16px;background-color:#fff;"><a href="http://package.elm-lang.org/packages/zaboco/elm-draggable/latest" class="Link" style="box-sizing:border-box;color:inherit;display:inline-block;font-size:14px;line-height:16px;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;font-weight:600;text-decoration:none;">Home</a><a href="https://github.com/zaboco/elm-draggable" class="Link" style="box-sizing:border-box;color:inherit;display:inline-block;font-size:14px;line-height:16px;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;font-weight:600;text-decoration:none;">GitHub</a></nav><header class="BannerHeader" style="display:flex;align-items:center;justify-content:center;text-align:left;min-height:100vh;color:white;background-color:#111;background-image:url(undefined);background-size:cover;background-position:center;"><div style="box-sizing:border-box;width:100%;max-width:1024px;margin-left:auto;margin-right:auto;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;"><h1 class="cxs-799160745" style="box-sizing:border-box;font-weight:600;line-height:1.25;margin:0;">elm-draggable</h1><h2 class="cxs-3954183383" style="box-sizing:border-box;font-weight:600;line-height:1.25;margin:0;">An easy way to make DOM elements draggable</h2><div class="cxs-1246195080" style="box-sizing:border-box;padding-top:16px;padding-bottom:16px;"><iframe src="https://platform.twitter.com/widgets/tweet_button.html?text=elm-draggable%3A%20An%20easy%20way%20to%20make%20DOM%20elements%20draggable&amp;url=http%3A%2F%2Fpackage.elm-lang.org%2Fpackages%2Fzaboco%2Felm-draggable%2Flatest&amp;via=&amp;hashtags=&amp;size=" height="20" allowtransparency="true" frameborder="0" scrolling="no" style="box-sizing:border-box;width:61px;overflow:hidden;margin:8px;"></iframe><iframe src="https://ghbtns.com/github-btn.html?type=star&amp;count=true&amp;user=zaboco&amp;repo=elm-draggable&amp;size=" height="20" frameborder="0" scrolling="no" style="box-sizing:border-box;width:100px;overflow:hidden;margin:8px;"></iframe><div class="cxs-4066908388 cxs-display-table"></div></div></div></header><div class="cxs-2947628758" style="box-sizing:border-box;max-width:1024px;margin-left:auto;margin-right:auto;padding-top:32px;padding-bottom:32px;padding-left:32px;padding-right:32px;"><article style="box-sizing:border-box;"><div>

<p><a href="http://elm-lang.org"><img src="https://img.shields.io/badge/elm-v0.18-blue.svg?style=flat-square" /></a>
<a href="https://travis-ci.org/zaboco/elm-draggable"><img src="https://travis-ci.org/zaboco/elm-draggable.svg?branch=master" /></a></p>
<h2>Install</h2>
<p>Have <a href="https://guide.elm-lang.org/install.html">elm installed</a>.</p>
<pre>elm package install --yes zaboco/elm-draggable</pre><h2>Live examples</h2>
<ul>
<li><a href="https://zaboco.github.io/elm-draggable/basic.html">Basic</a> / <a href="https://github.com/zaboco/elm-draggable/blob/master/examples/BasicExample.elm">Code</a></li>
<li><a href="https://zaboco.github.io/elm-draggable/custom.html">Custom events</a> / <a href="https://github.com/zaboco/elm-draggable/blob/master/examples/CustomEventsExample.elm">Code</a></li>
<li><a href="https://zaboco.github.io/elm-draggable/constraints.html">Constraints - restrict dragging to one axis at a time</a> / <a href="https://github.com/zaboco/elm-draggable/blob/master/examples/ConstraintsExample.elm">Code</a></li>
<li><a href="https://zaboco.github.io/elm-draggable/pan-and-zoom.html">Pan &amp; Zoom - drag to pan &amp; scroll to zoom</a> / <a href="https://github.com/zaboco/elm-draggable/blob/master/examples/PanAndZoomExample.elm">Code</a></li>
<li><a href="https://zaboco.github.io/elm-draggable/multiple.html">Multiple Targets</a> / <a href="https://github.com/zaboco/elm-draggable/blob/master/examples/MultipleTargetsExample.elm">Code</a></li>
</ul>
<h2>Usage</h2>
<p>This library is meant to be easy to use, by keeping its internal details hidden and only communicating to the parent application by emitting <a href="http://faq.elm-community.org/#how-do-i-generate-a-new-message-as-a-command"><code>Event</code> messages</a>. So, each time the internals change and something relevant happens (such as &quot;started dragging&quot;, &quot;dragged at&quot;, etc.), a new message is sent as a <code>Cmd</code> and handled in the main <code>update</code> function. To better understand how this works, see the snippets below and also the <a href="https://github.com/zaboco/elm-draggable/blob/master/examples/">working examples</a>.</p>
<h3>Basic</h3>
<p>In order to make a DOM element draggable, you'll need to:</p>
<h4>1. Import this library</h4>
<pre><span class="hljs-keyword">import</span> Draggable</pre><h4>2. Define your model</h4>
<p>Include:</p>
<ul>
<li>The element's position.</li>
<li>The internal <code>Drag</code> state. Note that, for simplicity, the model entry holding this state <strong>must</strong> be called <code>drag</code>, since the update function below follows this naming convention. A future update could allow using custom field names. Please note that for the sake of example, we are specifying <code>String</code> as the type to tag draggable elements with. If you have only one such element, <code>()</code> might be a better type.<pre><span class="hljs-keyword">type</span> <span class="hljs-keyword">alias</span> <span class="hljs-type">Model</span> =
  { position : ( <span class="hljs-type">Int</span>, <span class="hljs-type">Int</span> )
  , drag : <span class="hljs-type">Draggable</span>.<span class="hljs-type">State</span> <span class="hljs-type">String</span>
  }</pre></li>
</ul>
<h4>3. Initialize the <code>Drag</code> state and the element's position</h4>
<pre>initModel : Model
initModel =
    { position = ( 0, 0 )
    , drag = Draggable.init
    }</pre><h4>4. Define the message types that will be handled by your application</h4>
<ul>
<li><code>OnDragBy</code> is for actually updating the position, taking a <code>Draggable.Delta</code> as an argument. <code>Delta</code> is just an alias for a tuple of <code>(Float, Float)</code> and it represents the distance between two consecutive drag points.</li>
<li><code>DragMsg</code> is for handling internal <code>Drag</code> state updates.<pre><span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span>
  = <span class="hljs-type">OnDragBy</span> <span class="hljs-type">Draggable</span>.<span class="hljs-type">Delta</span>
  | <span class="hljs-type">DragMsg</span> (<span class="hljs-type">Draggable</span>.<span class="hljs-type">Msg</span> <span class="hljs-type">String</span>)</pre></li>
</ul>
<h4>5. Setup the config used when updating the <code>Drag</code> state</h4>
<p>For the simplest case, you only have to provide a handler for <code>onDragBy</code>:</p>
<pre>dragConfig : Draggable.Config String Msg
dragConfig =
    Draggable.basicConfig OnDragBy</pre><h4>6. Your update function must handle the messages declared above</h4>
<ul>
<li>For <code>OnDragBy</code>, which will be emitted when the user drags the element, the new position will be computed using the <code>Delta</code> <code>(dx, dy)</code></li>
<li><p><code>DragMsg</code> will be forwarded to <code>Draggable.update</code> which takes care of both updating the <code>Drag</code> state and sending the appropriate event commands. In order to do that, it receives the <code>dragConfig</code>. As mentioned above, this function assumes that the model has a <code>drag</code> field holding the internal <code>Drag</code> state.</p>
<pre><span class="hljs-title">update</span> : <span class="hljs-type">Msg</span> -&gt; <span class="hljs-type">Model</span> -&gt; ( <span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span> )
<span class="hljs-title">update</span> msg ({ position } <span class="hljs-keyword">as</span> model) =
  <span class="hljs-keyword">case</span> msg <span class="hljs-keyword">of</span>
      <span class="hljs-type">OnDragBy</span> ( dx, dy ) -&gt;
          <span class="hljs-keyword">let</span>
              ( x, y ) =
                  position
          <span class="hljs-keyword">in</span>
              { model | position = ( x + dx, y + dy ) } ! []

      <span class="hljs-type">DragMsg</span> dragMsg -&gt;
          <span class="hljs-type">Draggable</span>.update dragConfig dragMsg model</pre></li>
</ul>
<h4>7. In order to keep track of the mouse events, you must include the relevant subscriptions</h4>
<pre><span class="hljs-title">subscriptions</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Sub</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">subscriptions</span> { drag } =
    <span class="hljs-type">Draggable</span>.subscriptions <span class="hljs-type">DragMsg</span> drag</pre><h4>8. Triggering drag</h4>
<p>Inside your <code>view</code> function, you must somehow make the element draggable. You do that by adding a trigger for the <code>mousedown</code> event. You must also specify a <code>key</code> for that element. This can be useful when there are multiple drag targets in the same view.</p>
<p>Of course, you'll also have to style your DOM element such that it reflects its moving position (with <code>top: x; left: y</code> or <a href="http://www.w3schools.com/css/css3_2dtransforms.asp"><code>transform: translate</code></a>)</p>
<pre><span class="hljs-title">view</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Html</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">view</span> { position } =
    <span class="hljs-type">Html</span>.div
        [ <span class="hljs-type">Draggable</span>.mouseTrigger <span class="hljs-string">&quot;my-element&quot;</span> <span class="hljs-type">DragMsg</span>
        <span class="hljs-comment">-- , Html.Attributes.style (someStyleThatSetsPosition position)</span>
        ]
        [ <span class="hljs-type">Html</span>.text <span class="hljs-string">&quot;Drag me&quot;</span> ]</pre><p>For working demos, see the <a href="https://github.com/zaboco/elm-draggable/blob/master/examples/BasicExample.elm">basic example</a> or the <a href="https://github.com/zaboco/elm-draggable/blob/master/examples/MultipleTargetsExample.elm">examples with multiple targets</a></p>
<h4>9. Triggering on touch</h4>
<p>If you want to trigger drags on touch events (i.e. on mobile platforms) as well
as mouse events, you need to add <code>touchTriggers</code> to your elements. Building on
the previous example, it looks like this.</p>
<pre><span class="hljs-title">view</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Html</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">view</span> { position } =
    <span class="hljs-type">Html</span>.div
        [ <span class="hljs-type">Draggable</span>.mouseTrigger <span class="hljs-string">&quot;my-element&quot;</span> <span class="hljs-type">DragMsg</span>
        <span class="hljs-comment">-- , Html.Attributes.style (someStyleThatSetsPosition position)</span>
        ] ++ (<span class="hljs-type">Draggable</span>.touchTriggers <span class="hljs-string">&quot;my-element&quot;</span> <span class="hljs-type">DragMsg</span>)
        [ <span class="hljs-type">Html</span>.text <span class="hljs-string">&quot;Drag me&quot;</span> ]</pre><p>The
<a href="https://github.com/zaboco/elm-draggable/blob/master/examples/BasicExample.elm">basic example</a> demonstrates
this as well.</p>
<h3>Advanced</h3>
<h4>Custom config</h4>
<p>Besides tracking the mouse moves, this library can also track all the other associated events related to dragging. But, before enumerating these events, it's import to note that an element is not considered to be dragging if the mouse was simply clicked (without moving). That allows tracking both <code>click</code> and <code>drag</code> events:</p>
<ul>
<li>&quot;mouse down&quot; + &quot;mouse up&quot; = &quot;click&quot;</li>
<li>&quot;mouse down&quot; + &quot;mouse moves&quot; + &quot;mouse up&quot; = &quot;drag&quot;</li>
</ul>
<p>So, the mouse events are:</p>
<ul>
<li><code>onMouseDown</code> - on mouse press.</li>
<li><code>onDragStart</code> - on the first mouse move after pressing.</li>
<li><code>onDragBy</code> - on every mouse move.</li>
<li><code>onDragEnd</code> - on releasing the mouse after dragging.</li>
<li><code>onClick</code> - on releasing the mouse without dragging.</li>
</ul>
<p>All of these events are optional, and can be provided to <code>Draggable.customConfig</code> using an API similar to the one used by <code>VirtualDom.node</code> to specify the <code>Attribute</code>s. For example, if we want to handle all the events, we define the <code>config</code> like:</p>
<pre><span class="hljs-keyword">import</span> Draggable
<span class="hljs-keyword">import</span> Draggable.Events <span class="hljs-keyword">exposing</span> (onClick, onDragBy, onDragEnd, onDragStart, onMouseDown)

<span class="hljs-title">dragConfig</span> : <span class="hljs-type">Draggable</span>.<span class="hljs-type">Config</span> <span class="hljs-type">String</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">dragConfig</span> =
    <span class="hljs-type">Draggable</span>.customConfig
        [ onDragStart <span class="hljs-type">OnDragStart</span>
        , onDragEnd <span class="hljs-type">OnDragEnd</span>
        , onDragBy <span class="hljs-type">OnDragBy</span>
        , onClick <span class="hljs-type">CountClick</span>
        , onMouseDown (<span class="hljs-type">SetClicked</span> <span class="hljs-type">True</span>)
        ]</pre><p><strong>Note</strong>: If we need to handle <code>mouseup</code> after either a <code>drag</code> or a <code>click</code>, we can use the <code>DOM</code> event handler <code>onMouseUp</code> from <code>Html.Events</code> or <code>Svg.Events</code>.</p>
<p>See <a href="https://github.com/zaboco/elm-draggable/blob/master/examples/CustomEventsExample.elm">the full example</a></p>
<h4>Custom Delta</h4>
<p>By default, <code>OnDragBy</code> message will have a <code>Draggable.Delta</code> parameter, which, as we saw, is just an alias for <code>(Float, Float)</code>. However, there are situations when we would like some other data type for representing our <code>delta</code>.</p>
<p>Luckily, that's pretty easy using function composition. For example, we can use a <a href="http://package.elm-lang.org/packages/elm-community/linear-algebra/1.0.0/Math-Vector2#Vec2">Vec2</a> type from the <code>linear-algebra</code> library, which provides handy function like <code>translate</code>, <code>scale</code> and <code>negate</code>. And there is even a <a href="http://package.elm-lang.org/packages/elm-community/linear-algebra/1.0.0/Math-Vector2#fromTuple">simple way of converting our &quot;floats&quot; delta to a <code>Vec2</code></a></p>
<pre><span class="hljs-keyword">import</span> Math.Vector2 <span class="hljs-keyword">as</span> Vector2 <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Vec2</span>)

<span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span>
    = <span class="hljs-type">OnDragBy</span> <span class="hljs-type">Vec2</span>
<span class="hljs-comment">--  | ...</span>

<span class="hljs-title">dragConfig</span> : <span class="hljs-type">Draggable</span>.<span class="hljs-type">Config</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">dragConfig</span> =
    <span class="hljs-type">Draggable</span>.basicConfig (<span class="hljs-type">OnDragBy</span> &lt;&lt; <span class="hljs-type">Vector2</span>.fromTuple)</pre><p>There is actually <a href="https://github.com/zaboco/elm-draggable/blob/master/examples/PanAndZoomExample.elm">an example right for this use-case</a></p>
<h4>Custom mouse trigger</h4>
<p>There are cases when we need some additional information (e.g. mouse offset) about the <code>mousedown</code> event which triggers the drag. For these cases, there is an advanced <code>customMouseTrigger</code> which also takes a JSON <code>Decoder</code> for the <a href="https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent"><code>MouseEvent</code></a>.</p>
<pre><span class="hljs-keyword">import</span> Json.Decode <span class="hljs-keyword">as</span> Decode <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Decoder</span>)

<span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span>
    = <span class="hljs-type">CustomMouseDown</span> <span class="hljs-type">Draggable</span>.<span class="hljs-type">Msg</span> (<span class="hljs-type">Float</span>, <span class="hljs-type">Float</span>)
<span class="hljs-comment">--  | ...</span>

<span class="hljs-title">update</span> msg model =
    <span class="hljs-keyword">case</span> msg <span class="hljs-keyword">of</span>
        <span class="hljs-type">CustomMouseDown</span> dragMsg startPoint -&gt;
            { model | startPoint = startPoint }
                |&gt; <span class="hljs-type">Draggable</span>.update dragConfig dragMsg

<span class="hljs-title">view</span> { scene } =
    <span class="hljs-type">Svg</span>.svg
        [ <span class="hljs-type">Draggable</span>.customMouseTrigger mouseOffsetDecoder <span class="hljs-type">CustomMouseDown</span>
<span class="hljs-comment">--      , ...</span>
        ]
        []

<span class="hljs-title">mouseOffsetDecoder</span> : <span class="hljs-type">Decoder</span> (<span class="hljs-type">Float</span>, <span class="hljs-type">Float</span>)
<span class="hljs-title">mouseOffsetDecoder</span> =
    <span class="hljs-type">Decode</span>.map2 (,)
        (<span class="hljs-type">Decode</span>.field <span class="hljs-string">&quot;offsetX&quot;</span> <span class="hljs-type">Decode</span>.float)
        (<span class="hljs-type">Decode</span>.field <span class="hljs-string">&quot;offsetY&quot;</span> <span class="hljs-type">Decode</span>.float)</pre><p><a href="https://github.com/zaboco/elm-draggable/blob/master/examples/FreeDrawingExample.elm">Full example</a></p>
</div></article></div><footer><div style="box-sizing:border-box;max-width:1024px;margin-left:auto;margin-right:auto;margin-bottom:32px;padding-top:8px;padding-bottom:8px;padding-left:32px;padding-right:32px;"><div style="margin-left:-16px;margin-right:-16px;"><a href="https://github.com/zaboco/elm-draggable" class="Link" style="box-sizing:border-box;color:inherit;display:inline-block;font-size:14px;line-height:16px;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;font-weight:600;text-decoration:none;">GitHub</a><a href="https://github.com/zaboco" class="Link" style="box-sizing:border-box;color:inherit;display:inline-block;font-size:14px;line-height:16px;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;font-weight:600;text-decoration:none;">zaboco</a></div><div></div></div></footer></div><div style="font-family:-apple-system, sans-serif;font-size:12px;font-weight:600;text-align:right;padding:24px;color:#333;background-color:#eee;"><a href="http://compositor.io" style="color:inherit;text-decoration:none;">Built with Compositor.io</a></div></body></html>